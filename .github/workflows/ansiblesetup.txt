# setting up environment to run the playbooks on managed node from ansible agent.
1. establish communication between github agent1 and ansible managed node.
2. on agent run below command to generate rsa key for ssh establishment.
ssh-keygen -t rsa -b 4096
Generating public/private rsa key pair.
Enter file in which to save the key (/home/githuba/.ssh/id_rsa):
Enter passphrase (empty for no passphrase):
Enter same passphrase again:
Your identification has been saved in /home/githuba/.ssh/id_rsa
Your public key has been saved in /home/githuba/.ssh/id_rsa.pub
The key fingerprint is:
SHA256:QVBWKXZYFc/XOWP6nDNZrs55g3Yf6sa7FTq5HqGJpNQ githuba@GHAAGENT1
The key's randomart image is:
+---[RSA 4096]----+
|      .o++ooo.   |
|       o+ o  o  o|
|       ..o    o=o|
|        ..    o.o|
|       .SE   o ..|
|      . o . o *.=|
|       . . o.=.X.|
|             **==|
|            =OO.+|
+----[SHA256]-----+



githuba@GHAAGENT1:~/.ssh$ pwd
/home/githuba/.ssh
githuba@GHAAGENT1:~/.ssh$ ls -lrt
total 8
-rw------- 1 githuba githuba    0 Feb 20 00:32 authorized_keys
-rw------- 1 githuba githuba 3381 Feb 25 00:29 id_rsa
-rw-r--r-- 1 githuba githuba  743 Feb 25 00:29 id_rsa.pub

this will create a pub and private key for user "githuba"

3.then copy the publick key to NodeAnsible(managed node)
ssh-copy-id githuba@172.19.0.5
/usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed: "/home/githuba/.ssh/id_rsa.pub"
The authenticity of host '172.19.0.5 (172.19.0.5)' can't be established.
ED25519 key fingerprint is SHA256:DPEDCpbFySp4YYetHMSUAawWkTPNYhXoOjSeG7HKXD4.
This key is not known by any other names.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
/usr/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed
/usr/bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- if you are prompted now it is to install the new keys

githuba@172.19.0.5's password:
Permission denied, please try again.

after entering the password it shows "permission denied" which means 
- Wrong username: You may be trying to connect as githuba, but ansibleNode1 might expect a different user (e.g., ubuntu, ec2-user, root, etc.).
- Password authentication disabled: The remote server may have PasswordAuthentication no in /etc/ssh/sshd_config.
- Permissions issue: The user may not have a home directory or .ssh folder with the right permissions.
- Firewall/SELinux restrictions: Less common, but can block SSH key installation.

username password is correct but the problem might be with password auntentication dibaled. --> "PasswordAuthentication yes"

once this is solved now it workd.
ssh-copy-id githuba@172.19.0.5
/usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed: "/home/githuba/.ssh/id_rsa.pub"
/usr/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed
/usr/bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- if you are prompted now it is to install the new keys
githuba@172.19.0.5's password:

Number of key(s) added: 1

Now try logging into the machine, with:   "ssh 'githuba@172.19.0.5'"
and check to make sure that only the key(s) you wanted were added.


ssh access rom agent to ansible agent has been setup.

githuba@GHAAGENT1:~/.ssh$ ssh 'githuba@172.19.0.5'
Welcome to Ubuntu 24.04.3 LTS (GNU/Linux 6.14.0-1017-azure x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/pro

 System information as of Wed Feb 25 00:38:11 UTC 2026

  System load:  0.0               Processes:             137
  Usage of /:   5.8% of 28.02GB   Users logged in:       1
  Memory usage: 3%                IPv4 address for eth0: 172.19.0.5
  Swap usage:   0%

 * Strictly confined Kubernetes makes edge and IoT secure. Learn how MicroK8s
   just raised the bar for easy, resilient and secure K8s cluster deployment.

   https://ubuntu.com/engage/secure-kubernetes-at-the-edge

Expanded Security Maintenance for Applications is not enabled.

0 updates can be applied immediately.

Enable ESM Apps to receive additional future security updates.
See https://ubuntu.com/esm or run: sudo pro status


The list of available updates is more than a week old.
To check for new updates run: sudo apt update

Last login: Wed Feb 25 00:29:06 2026 from 49.43.231.131



4. Now install Asnible on Runner.
sudo apt update
sudo apt install ansible -y

5. once above comamds run --> check for version--> ansible --version
ansible --version
ansible [core 2.16.3]
  config file = None
  configured module search path = ['/home/githuba/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /usr/lib/python3/dist-packages/ansible
  ansible collection location = /home/githuba/.ansible/collections:/usr/share/ansible/collections
  executable location = /usr/bin/ansible
  python version = 3.12.3 (main, Jan 22 2026, 20:57:42) [GCC 13.3.0] (/usr/bin/python3)
  jinja version = 3.1.2
  libyaml = True

6. create an inventory as below.
cat inventory.ini
[managednode1]
ansibleNode1 ansible_host=172.19.0.5 ansible_user=githuba ansible_ssh_private_key_file=/home/githuba/.ssh/id_rsa

7. run the ping module from control to managed node
ansible -i inventory.ini managednode1 -m ping
ansibleNode1 | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python3"
    },
    "changed": false,
    "ping": "pong"
}


